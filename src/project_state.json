{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 25,
  "summary": "Role-based internal web application for Braindemics to manage shared School records across departments with strict RBAC, dashboards, form-based workflows, PDF uploads, search/filtering, and full audit logging; additionally, support a test/preview mode with dummy login to access screens without Internet Identity.",
  "architectural_notes": [
    "Single shared School ID is the primary key linking all department modules (payments, packing, training visits, academic queries).",
    "Strict RBAC: Marketing-only create/edit school core details; other roles read-only for core school info; Admin has full access.",
    "Role-based post-login routing to dashboards.",
    "All mutating actions must be audit-logged with timestamp and user identity.",
    "PDF uploads only for specified entities (payment proof, classroom observations).",
    "Desktop-first responsive UI; clean functional design prioritized.",
    "Tables should support filtering and search; forms must validate and show clear errors.",
    "Introduce a configurable test/preview mode (feature flag) that can bypass Internet Identity and use dummy credentials/roles for QA/demo access while keeping production auth unchanged.",
    "Packing module must support controlled vocabularies for Class (Beginner/Explorer/Master) and Theme (MYSELF, SHAPES, ANIMAL KINGDOM, PLANT TREES AND FLOWERS, FRUITS AND VEGETABLES, FIVE ELEMENTS) stored per School and editable via Packing UI.",
    "School details should be displayed read-only on Admin/Packing when a School is selected, while allowing module-specific fields (e.g., outstanding, packing status/counts) to be edited."
  ],
  "known_issues": [
    "Login blocked with message \"Access not configured. Please contact your administrator to set up your staff profile.\" persists even after attempted setup; indicates staff profile ↔ Internet Identity principal mapping not being created/loaded correctly.",
    "Demo/Preview Mode login: entering dummy user ID/password does not route into the app/dashboard; user cannot access pages to explore the app.",
    "Demo/Preview Mode: key module flows are not fully working end-to-end (school registration/reflection across pages, outstanding updates, packing edits), preventing full-page testing in demo mode.",
    "School registration fails with runtime error: \"Do not know how to serialize a BigInt\" (likely BigInt value being returned/JSON-serialized in API response).",
    "Demo/Preview Mode can get stuck in an infinite loading state when localStorage persistence fails (e.g., BigInt serialization error), preventing the UI from completing data load.",
    "Training page Edit option currently renders without a background color (transparent/no background), causing readability/UI issues; needs white background styling.",
    "Demo/Preview Mode top-banner role switcher dropdown background is not white (needs light-mode white background).",
    "Training Visit form: entire form container background is not white in light mode (needs solid white surface)."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-implement-secure-authentication-using-internet-identity-and-a-common-login-page-that-signs-the-user-in-and-then-redirects-them-to-the-correct-role-dashboard-based-on-their-staff-role",
      "title": "Implement secure authentication using Internet Identity and a common login page that signs the user in and then redirects them to the correct role dashboard based on their staff role.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-enforce-strict-role-based-access-control-rbac-in-the-backend-for-every-mutation-and-sensitive-read-according-to-the-six-roles-the-frontend-must-also-guard-routes-and-disable-hide-unauthorized-actions-but-backend-enforcement-is-the-source-of-truth",
      "title": "Enforce strict role-based access control (RBAC) in the backend for every mutation and sensitive read according to the six roles; the frontend must also guard routes and disable/hide unauthorized actions, but backend enforcement is the source of truth.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-staff-management-and-role-assignment-so-that-admin-can-create-update-staff-records-and-associate-an-internet-identity-principal-with-a-staff-profile-name-role-department-contact-details-use-this-mapping-to-resolve-roles-after-login",
      "title": "Implement Staff management and role assignment so that Admin can create/update staff records and associate an Internet Identity principal with a staff profile (name, role, department, contact details); use this mapping to resolve roles after login.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-build-role-specific-dashboards-admin-accounts-packing-marketing-training-academic-with-summary-cards-relevant-tables-and-notifications-derived-from-the-shared-school-data-and-each-department-s-workflow-state",
      "title": "Build role-specific dashboards (Admin, Accounts, Packing, Marketing, Training, Academic) with summary cards, relevant tables, and notifications derived from the shared school data and each department’s workflow state.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-marketing-module-pages-to-register-new-schools-and-edit-school-details-including-student-count-updates-ensure-created-schools-become-visible-to-other-roles-immediately-via-the-shared-school-id",
      "title": "Implement Marketing module pages to register new schools and edit school details, including student count updates; ensure created schools become visible to other roles immediately via the shared School ID.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-accounts-module-to-view-school-details-and-manage-payments-update-outstanding-payments-payment-status-due-dates-amounts-as-needed-and-upload-download-payment-proof-pdfs-prevent-accounts-from-editing-school-core-details",
      "title": "Implement Accounts module to view school details and manage payments: update outstanding payments, payment status, due dates/amounts as needed, and upload/download payment proof PDFs; prevent Accounts from editing school core details.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-packing-module-to-view-school-details-and-update-packing-status-student-kit-count-add-on-count-packing-dispatch-status-and-dispatch-details-and-current-curriculum-theme-ensure-updates-are-visible-to-other-departments",
      "title": "Implement Packing module to view school details and update packing status: student kit count, add-on count, packing/dispatch status and dispatch details, and current curriculum theme; ensure updates are visible to other departments.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-training-module-to-log-training-visits-and-raise-academic-queries-record-visit-date-reason-visiting-person-contact-person-mobile-number-observations-upload-download-classroom-observation-pdfs-and-create-academic-queries-linked-to-the-school",
      "title": "Implement Training module to log training visits and raise academic queries: record visit date, reason, visiting person, contact person mobile number, observations, upload/download classroom observation PDFs, and create academic queries linked to the school.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-academic-module-to-view-academic-queries-raised-by-trainers-respond-to-them-and-update-query-status-ensure-query-lifecycle-and-responses-are-fully-auditable",
      "title": "Implement Academic module to view academic queries raised by trainers, respond to them, and update query status; ensure query lifecycle and responses are fully auditable.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-add-global-tables-with-filtering-and-search-for-key-lists-schools-payments-packing-statuses-training-visits-academic-queries-and-ensure-all-data-entry-is-form-based-with-validation-and-clear-english-error-handling",
      "title": "Add global tables with filtering and search for key lists (schools, payments, packing statuses, training visits, academic queries) and ensure all data entry is form-based with validation and clear English error handling.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-comprehensive-audit-logging-system-for-all-create-update-actions-across-modules-schools-staff-payments-packing-visits-queries-and-provide-an-admin-facing-activity-audit-log-viewer-with-filtering-by-actor-entity-type-school-id-and-date-range",
      "title": "Implement a comprehensive audit logging system for all create/update actions across modules (schools, staff, payments, packing, visits, queries) and provide an Admin-facing activity/audit log viewer with filtering by actor, entity type, school ID, and date range.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-deliver-a-clean-simple-functional-responsive-desktop-first-ui-with-a-coherent-visual-theme-applied-consistently-across-dashboards-forms-and-tables",
      "title": "Deliver a clean, simple, functional, responsive (desktop-first) UI with a coherent visual theme applied consistently across dashboards, forms, and tables.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-the-login-page-diagnostics-so-that-when-a-signed-in-user-has-no-staff-profile-the-ui-also-shows-the-user-s-current-internet-identity-principal-as-text-with-a-clear-copy-action-to-reduce-principal-mismatch-errors-during-staff-setup",
      "title": "Improve the login page diagnostics so that when a signed-in user has no staff profile, the UI also shows the user’s current Internet Identity Principal (as text) with a clear “Copy” action, to reduce principal mismatch errors during staff setup.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-differentiate-between-no-staff-profile-exists-vs-request-failed-due-to-authorization-backend-error-during-profile-fetch-and-show-an-explicit-english-error-message-for-the-latter-instead-of-showing-the-access-not-configured-message",
      "title": "Differentiate between “no staff profile exists” vs “request failed due to authorization/backend error” during profile fetch, and show an explicit English error message for the latter (instead of showing the “Access not configured” message).",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-expose-the-new-admin-repair-operation-in-the-admin-staff-management-page-as-a-clearly-labeled-action-e-g-repair-staff-access-including-confirmation-and-success-error-feedback-so-administrators-can-fix-login-access-issues-without-redeploying-or-manual-intervention",
      "title": "Expose the new Admin repair operation in the Admin Staff Management page as a clearly labeled action (e.g., “Repair staff access”), including confirmation and success/error feedback, so administrators can fix login access issues without redeploying or manual intervention.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-frontend-only-demo-preview-mode-login-path-on-the-existing-login-screen-that-allows-signing-in-with-dummy-username-password-no-internet-identity-and-routes-the-user-into-the-admin-dashboard-for-testing-on-a-laptop-preview-build",
      "title": "Add a frontend-only “Demo / Preview Mode” login path on the existing login screen that allows signing in with dummy username/password (no Internet Identity) and routes the user into the Admin dashboard for testing on a laptop preview build.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-persistent-client-side-session-flag-for-demo-preview-mode-e-g-stored-in-sessionstorage-localstorage-and-use-it-to-provide-a-synthetic-userprofile-admin-by-default-to-the-app-so-route-guards-and-layouts-treat-the-user-as-authenticated-during-demo-testing",
      "title": "Implement a persistent client-side session flag for Demo/Preview Mode (e.g., stored in sessionStorage/localStorage) and use it to provide a synthetic UserProfile (Admin by default) to the app so route guards and layouts treat the user as authenticated during demo testing.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-in-app-demo-preview-banner-and-role-switcher-while-in-demo-preview-mode-to-help-testers-see-all-screens-by-switching-between-admin-marketing-accounts-packing-training-academic-views-without-re-authentication",
      "title": "Add an in-app Demo/Preview banner and role switcher while in Demo/Preview Mode to help testers “see all screens” by switching between Admin/Marketing/Accounts/Packing/Training/Academic views without re-authentication.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-in-demo-preview-mode-ensure-screens-that-normally-load-backend-data-remain-navigable-and-do-not-hard-crash-if-backend-calls-fail-show-a-clear-english-demo-mode-data-is-not-available-empty-state-where-needed",
      "title": "In Demo/Preview Mode, ensure screens that normally load backend data remain navigable and do not hard-crash if backend calls fail; show a clear, English “Demo mode: data is not available” empty state where needed.",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-explicit-exit-demo-preview-mode-action-in-the-authenticated-layout-that-clears-the-demo-session-and-returns-the-user-to-the-normal-login-screen",
      "title": "Add an explicit “Exit Demo/Preview Mode” action in the authenticated layout that clears the demo session and returns the user to the normal login screen.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-demo-preview-mode-sign-in-flow-so-that-entering-the-demo-username-password-successfully-routes-the-user-into-the-authenticated-app-starting-at-the-admin-dashboard-without-being-redirected-back-to-login-by-route-guards",
      "title": "Fix the Demo/Preview Mode sign-in flow so that entering the demo username/password successfully routes the user into the authenticated app (starting at the Admin dashboard) without being redirected back to /login by route guards.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-tanstack-router-route-protection-explicitly-supports-demo-preview-mode-by-allowing-the-authenticated-route-guard-s-to-treat-a-demo-session-as-authenticated-and-to-source-the-profile-from-the-demo-profile-factory-not-from-backend-actor-calls",
      "title": "Ensure TanStack Router route protection explicitly supports Demo/Preview Mode by allowing the authenticated route guard(s) to treat a demo session as authenticated and to source the profile from the demo profile factory (not from backend actor calls).",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-the-login-screen-ux-so-demo-login-failures-and-internet-identity-login-profile-issues-cannot-conflict-or-confuse-the-user-show-only-the-relevant-error-for-the-login-method-being-attempted-using-clear-english",
      "title": "Improve the login screen UX so demo login failures and Internet Identity login/profile issues cannot conflict or confuse the user; show only the relevant error for the login method being attempted, using clear English.",
      "reqIds": [
        "REQ-27"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-in-app-change-requests-section-that-lets-authenticated-users-record-the-specific-changes-and-add-ons-they-want-on-particular-pages-since-the-current-request-does-not-specify-which-pages-or-what-changes-are-needed",
      "title": "Add an in-app \"Change Requests\" section that lets authenticated users record the specific \"changes and add ons\" they want on particular pages, since the current request does not specify which pages or what changes are needed.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-packing-module-ui-to-support-searching-and-selecting-a-school-instead-of-relying-only-on-a-pre-selected-route-param-then-show-the-selected-school-s-details-as-read-only-and-allow-updating-packing-status-for-that-selected-school",
      "title": "Update the Packing module UI to support searching and selecting a school (instead of relying only on a pre-selected route param), then show the selected school’s details as read-only and allow updating packing status for that selected school.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-extend-packing-status-editing-to-include-two-dropdowns-for-class-and-theme-with-the-exact-option-sets-requested-and-ensure-the-selected-values-are-saved-and-reloaded-for-each-school",
      "title": "Extend Packing status editing to include two dropdowns for Class and Theme with the exact option sets requested, and ensure the selected values are saved and reloaded for each school.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-counts-section-on-the-packing-page-for-the-selected-school-that-allows-entering-and-saving-counts-associated-with-the-selected-class-and-theme-and-ensure-these-values-are-persisted-and-reloaded",
      "title": "Add a “counts” section on the Packing page for the selected school that allows entering and saving counts associated with the selected Class and Theme, and ensure these values are persisted and reloaded.",
      "reqIds": [
        "REQ-31"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-admin-workflow-to-search-and-select-a-school-and-set-update-an-outstanding-amount-for-the-selected-school-selected-school-details-must-be-displayed-read-only-alongside-the-outstanding-field",
      "title": "Add an Admin workflow to search and select a school and set/update an Outstanding Amount for the selected school; selected school details must be displayed read-only alongside the outstanding field.",
      "reqIds": [
        "REQ-32"
      ],
      "version": 1
    },
    {
      "id": "feature-expose-the-school-s-outstanding-amount-in-the-marketing-module-when-viewing-selecting-any-school-so-marketing-can-see-the-outstanding-value-set-by-admin-and-or-accounts",
      "title": "Expose the school’s Outstanding Amount in the Marketing module when viewing/selecting any school, so Marketing can see the outstanding value set by Admin (and/or Accounts).",
      "reqIds": [
        "REQ-33"
      ],
      "version": 1
    },
    {
      "id": "feature-make-core-flows-work-end-to-end-in-demo-preview-mode-without-backend-access-school-registration-school-reflection-across-pages-outstanding-updates-and-packing-edits-must-all-function-using-demo-local-persisted-data",
      "title": "Make core flows work end-to-end in Demo/Preview Mode (without backend access): school registration, school reflection across pages, outstanding updates, and packing edits must all function using demo-local persisted data.",
      "reqIds": [
        "REQ-34"
      ],
      "version": 1
    },
    {
      "id": "feature-allow-admin-to-register-schools-create-school-in-non-demo-mode-and-ensure-newly-created-schools-appear-immediately-across-modules-wherever-school-search-listing-is-used",
      "title": "Allow Admin to register schools (create school) in non-demo mode, and ensure newly created schools appear immediately across modules wherever school search/listing is used.",
      "reqIds": [
        "REQ-35"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-demo-preview-mode-localstorage-persistence-for-school-records-so-registering-a-school-does-not-throw-do-not-know-how-to-serialize-a-bigint-when-saving-to-localstorage",
      "title": "Fix Demo/Preview Mode localStorage persistence for School records so registering a school does not throw \"Do not know how to serialize a BigInt\" when saving to localStorage.",
      "reqIds": [
        "REQ-36"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-user-facing-error-handling-for-school-registration-never-attempts-to-json-serialize-raw-objects-containing-bigint-values-show-a-clear-english-error-message-when-school-registration-fails",
      "title": "Ensure user-facing error handling for school registration never attempts to JSON-serialize raw objects containing bigint values; show a clear English error message when school registration fails.",
      "reqIds": [
        "REQ-37"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-demo-preview-mode-infinite-loading-by-ensuring-demo-mode-react-query-hooks-run-even-when-the-backend-actor-is-not-available-so-dashboard-pages-e-g-marketing-admin-dashboards-stop-showing-endless-loading-states-in-demo-mode",
      "title": "Fix Demo/Preview Mode infinite loading by ensuring demo-mode React Query hooks run even when the backend actor is not available, so dashboard pages (e.g., Marketing/Admin dashboards) stop showing endless loading states in demo mode.",
      "reqIds": [
        "REQ-38"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-demo-preview-mode-remains-resilient-if-localstorage-contains-corrupted-unparseable-demo-data-by-preventing-hard-failures-and-presenting-a-clear-english-fallback-behavior-that-allows-navigation-to-continue",
      "title": "Ensure Demo/Preview Mode remains resilient if localStorage contains corrupted/unparseable demo data by preventing hard failures and presenting a clear, English fallback behavior that allows navigation to continue.",
      "reqIds": [
        "REQ-39"
      ],
      "version": 1
    },
    {
      "id": "feature-in-demo-preview-mode-make-accounts-able-to-view-and-update-the-selected-school-s-outstanding-amount-from-the-accounts-workflow-and-ensure-the-updated-outstanding-amount-is-persisted-in-demo-localstorage-and-reflected-immediately-anywhere-the-school-is-viewed-including-marketing",
      "title": "In Demo/Preview Mode, make Accounts able to view and update the selected school’s Outstanding Amount from the Accounts workflow, and ensure the updated outstanding amount is persisted in demo localStorage and reflected immediately anywhere the school is viewed (including Marketing).",
      "reqIds": [
        "REQ-40"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-marketing-dashboard-page-ui-to-remove-the-register-school-button-and-instead-show-1-total-schools-2-total-outstanding-amount-sum-across-schools-and-3-a-schools-section-that-lists-every-school-with-its-outstanding-amount-selecting-a-school-must-show-detailed-school-information-including-outstanding-amount-and-packing-details-sourced-from-packing-updates-dispatch-information-and-class-theme-counts",
      "title": "Update the Marketing dashboard/page UI to remove the “Register School” button and instead show: (1) Total Schools, (2) Total Outstanding Amount (sum across schools), and (3) a schools section that lists every school with its outstanding amount; selecting a school must show detailed school information including outstanding amount and packing details sourced from Packing updates (dispatch information and Class/Theme/Counts).",
      "reqIds": [
        "REQ-41"
      ],
      "version": 1
    },
    {
      "id": "feature-in-demo-preview-mode-make-training-module-school-workflows-fully-functional-when-a-trainer-selects-opens-a-school-they-can-1-create-academic-queries-for-that-school-2-log-training-visits-with-purpose-reason-of-visit-contacted-person-name-contacted-person-mobile-number-and-observations-and-3-attach-upload-a-file-as-part-of-the-training-visit-record-all-of-this-must-persist-in-demo-localstorage-and-be-viewable-after-reload",
      "title": "In Demo/Preview Mode, make Training module school workflows fully functional: when a trainer selects/opens a school, they can (1) create academic queries for that school, (2) log training visits with Purpose/Reason of visit, Contacted Person name, Contacted Person mobile number, and observations, and (3) attach/upload a file as part of the training visit record; all of this must persist in demo localStorage and be viewable after reload.",
      "reqIds": [
        "REQ-42"
      ],
      "version": 1
    },
    {
      "id": "feature-in-demo-preview-mode-make-the-academic-module-receive-trainer-raised-queries-and-allow-academic-users-to-respond-and-update-query-status-any-status-updates-and-responses-must-persist-in-demo-localstorage-and-reflect-back-on-the-trainer-s-query-views-for-the-same-query",
      "title": "In Demo/Preview Mode, make the Academic module receive trainer-raised queries and allow academic users to respond and update query status; any status updates and responses must persist in demo localStorage and reflect back on the trainer’s query views for the same query.",
      "reqIds": [
        "REQ-43"
      ],
      "version": 1
    },
    {
      "id": "feature-extend-the-demo-localstorage-data-store-to-support-persistence-and-retrieval-for-training-visits-including-attached-file-metadata-content-representation-and-academic-queries-including-status-and-responses-using-a-bigint-safe-serialization-strategy-store-bigint-as-strings-and-resilient-parsing-with-reset-fallback-behavior-consistent-with-existing-demo-data-store-patterns",
      "title": "Extend the demo localStorage data store to support persistence and retrieval for Training Visits (including attached file metadata/content representation) and Academic Queries (including status and responses), using a BigInt-safe serialization strategy (store bigint as strings) and resilient parsing with reset/fallback behavior consistent with existing demo data store patterns.",
      "reqIds": [
        "REQ-44"
      ],
      "version": 1
    },
    {
      "id": "feature-update-demo-mode-ui-mutation-gating-so-that-demo-workflows-required-for-end-to-end-testing-are-allowed-outstanding-amount-updates-packing-updates-counts-training-visit-logging-with-file-attach-trainer-query-creation-academic-query-response-status-updates-while-keeping-non-required-mutations-still-blocked-in-demo-mode-with-clear-english-messages",
      "title": "Update demo-mode UI mutation gating so that demo workflows required for end-to-end testing are allowed (Outstanding Amount updates, Packing updates/counts, Training visit logging with file attach, Trainer query creation, Academic query response/status updates), while keeping non-required mutations still blocked in demo mode with clear English messages.",
      "reqIds": [
        "REQ-45"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-admin-can-view-consolidated-visibility-into-demo-mode-updates-across-modules-outstanding-amounts-packing-status-counts-training-visits-and-academic-queries-including-statuses-responses-so-admin-can-know-all-of-these-pages-updates-and-details-during-demo-testing",
      "title": "Ensure Admin can view consolidated visibility into demo-mode updates across modules (Outstanding Amounts, Packing status/counts, Training visits, and Academic Queries including statuses/responses), so Admin can “know all of these pages updates and details” during demo testing.",
      "reqIds": [
        "REQ-46"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-academic-queries-list-ui-to-display-the-school-name-alongside-the-school-id-for-every-query-using-the-existing-schools-data-as-the-source-of-truth-for-mapping-schoolid-school-name",
      "title": "Update the Academic Queries list UI to display the School Name alongside the School ID for every query, using the existing Schools data as the source of truth for mapping schoolId -> school.name.",
      "reqIds": [
        "REQ-47"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-solved-queries-overview-to-the-training-dashboard-alongside-the-existing-summary-cards-based-on-academic-queries-with-status-resolved",
      "title": "Add a “Solved Queries” overview to the Training Dashboard, alongside the existing summary cards, based on academic queries with status = resolved.",
      "reqIds": [
        "REQ-48"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-edit-option-for-existing-training-visit-records-on-the-school-training-page-allowing-users-to-update-the-visit-details-visit-date-purpose-reason-visiting-person-contacted-person-mobile-observations-and-optionally-replace-remove-the-attached-proof-file-and-persist-the-updates",
      "title": "Add an Edit option for existing Training Visit records on the School Training page, allowing users to update the visit details (visit date, purpose/reason, visiting person, contacted person mobile, observations, and optionally replace/remove the attached proof file) and persist the updates.",
      "reqIds": [
        "REQ-49"
      ],
      "version": 1
    },
    {
      "id": "feature-create-an-admin-workflow-where-an-admin-can-select-a-school-and-view-a-single-consolidated-school-details-page-that-combines-the-latest-data-from-all-modules-school-core-details-outstanding-amount-packing-status-counts-training-visits-academic-queries-and-shows-who-last-updated-each-section-name-based-on-login-staff-profile-and-when-it-was-last-updated",
      "title": "Create an Admin workflow where an Admin can select a school and view a single consolidated school details page that combines the latest data from all modules (School core details, Outstanding Amount, Packing status + counts, Training visits, Academic queries), and shows who last updated each section (name based on login/staff profile) and when it was last updated.",
      "reqIds": [
        "REQ-51"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-the-provided-brand-palette-across-the-ui-brand-heading-accents-and-component-primary-accent-colors-using-e73d4b-brand-red-3bbcc4-and-28b06f-while-not-changing-any-background-colors-anywhere-in-the-app",
      "title": "Apply the provided brand palette across the UI (Brand/heading accents and component primary/accent colors) using: #e73d4b (brand red), #3bbcc4, and #28b06f, while not changing any background colors anywhere in the app.",
      "reqIds": [
        "REQ-53"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-all-new-modified-flows-academic-queries-display-training-dashboard-solved-overview-training-visit-editing-admin-consolidated-school-details-include-robust-error-handling-and-do-not-introduce-crashes-errors-must-be-shown-in-clear-english-and-avoid-bigint-json-serialization-pitfalls",
      "title": "Ensure all new/modified flows (Academic Queries display, Training Dashboard solved overview, Training Visit editing, Admin consolidated school details) include robust error handling and do not introduce crashes; errors must be shown in clear English and avoid BigInt JSON serialization pitfalls.",
      "reqIds": [
        "REQ-54"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-training-module-edit-experience-so-the-create-edit-training-visit-dialog-always-renders-with-an-explicit-solid-white-light-mode-solid-app-background-theme-background-and-does-not-appear-transparent-or-without-background-color-update-the-dialog-styling-in-frontend-src-pages-training-schooltrainingpage-tsx-so-the-dialog-content-area-clearly-separates-from-the-overlay-and-page-content-e-g-explicit-background-border-and-shadow-while-keeping-all-existing-fields-labels-and-actions-unchanged",
      "title": "Fix the Training module “Edit” experience so the Create/Edit Training Visit dialog always renders with an explicit solid white (light mode) / solid app background (theme background) and does not appear transparent or “without background color”. Update the dialog styling in `frontend/src/pages/training/SchoolTrainingPage.tsx` so the dialog content area clearly separates from the overlay and page content (e.g., explicit background, border, and shadow) while keeping all existing fields, labels, and actions unchanged.",
      "reqIds": [
        "REQ-55"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-additional-appropriate-background-colors-where-needed-as-a-small-consistent-ui-polish-pass-focused-on-training-module-screens-only-to-avoid-unintended-global-design-changes-ensure-training-pages-use-consistent-surface-styling-for-key-sections-page-container-cards-and-any-inline-detail-blocks-using-existing-tailwind-theme-tokens-bg-background-bg-card-bg-muted-etc-so-no-section-appears-visually-unfinished-or-blends-into-the-page-background",
      "title": "Apply additional “appropriate background colors where needed” as a small, consistent UI polish pass focused on Training module screens only (to avoid unintended global design changes): ensure Training pages use consistent surface styling for key sections (page container, cards, and any inline detail blocks) using existing Tailwind/theme tokens (`bg-background`, `bg-card`, `bg-muted`, etc.) so no section appears visually unfinished or blends into the page background.",
      "reqIds": [
        "REQ-56"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-ui-changes-do-not-introduce-runtime-errors-and-that-any-user-facing-error-messages-remain-clear-english-specifically-verify-that-opening-closing-the-training-visit-dialog-create-and-edit-saving-and-canceling-do-not-throw-errors-and-do-not-break-demo-preview-mode-behavior",
      "title": "Ensure the UI changes do not introduce runtime errors and that any user-facing error messages remain clear English. Specifically verify that opening/closing the Training Visit dialog (create and edit), saving, and canceling do not throw errors and do not break Demo/Preview Mode behavior.",
      "reqIds": [
        "REQ-57"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-demo-preview-mode-role-switcher-dropdown-in-the-top-banner-so-its-trigger-and-opened-dropdown-surface-render-with-a-solid-white-background-in-light-mode-while-preserving-existing-styling-behavior-in-dark-mode",
      "title": "Update the Demo/Preview Mode role switcher dropdown in the top banner so its trigger and opened dropdown surface render with a solid white background in light mode, while preserving existing styling behavior in dark mode.",
      "reqIds": [
        "REQ-58"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-training-module-training-visit-create-edit-form-container-to-have-a-solid-white-background-in-light-mode-entire-form-container-while-preserving-existing-styling-behavior-in-dark-mode",
      "title": "Update the Training module Training Visit create/edit form container to have a solid white background in light mode (entire form container), while preserving existing styling behavior in dark mode.",
      "reqIds": [
        "REQ-59"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Implement secure authentication with role-based login redirect to role dashboards (Admin, Accounts, Packing, Marketing, Training, Academic)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Implement strict role-based access control rules, including Marketing-only school creation and view-only core school details for non-Marketing roles",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Create core data models and shared School ID workflow (School, Staff, Payment, Packing Status, Training Visit, Academic Query)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Build role-specific dashboards with summary cards, tables, notifications, and Admin global visibility/insights",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Build form-based CRUD pages with validation and clear error handling across modules (schools, payments, packing, visits, queries)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Enable PDF upload/download where required (payment proof PDFs, classroom observation PDFs)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Add table search and filtering on key lists (schools, payments, packing, visits, queries)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Implement audit logging for all actions/updates with timestamps and actor identity; Admin can review activity",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Deliver responsive desktop-first UI with clean, simple, functional design",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Adopt scalable, modular application architecture to support multi-department workflows on shared school data",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Create the core backend data models and persistence for: School, Staff, Payment, Packing Status, Training Visit, Academic Query, and Audit Log entries; ensure all department operations reference a single shared School ID and records are time-stamped.",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Ensure a user with a valid StaffProfile can always retrieve their profile via getCallerUserProfile after signing in with Internet Identity, without requiring any additional manual access-control setup beyond staff profile creation.",
      "reqIds": [
        "REQ-14"
      ],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "When an Admin creates a staff profile using createStaffProfile, automatically grant the created staff principal the minimum required permission(s) needed to call profile endpoints (e.g., getCallerUserProfile/saveCallerUserProfile), so newly created staff can log in immediately.",
      "reqIds": [
        "REQ-15"
      ],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Add an Admin-only backend repair operation that can backfill missing minimum profile-access permissions for already-existing staff profiles (created before this fix), so existing staff can log in without recreating profiles.",
      "reqIds": [
        "REQ-16"
      ],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Add a test/preview login mode with dummy username/password (or simple Admin sign-in) that bypasses Internet Identity so testers can access the app and view all screens on a laptop preview build.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Packing page: add School search/select; show selected school details read-only; allow status update with two dropdowns (Class: Beginner/Explorer/Master; Theme: MYSELF, SHAPES, ANIMAL KINGDOM, PLANT TREES AND FLOWERS, FRUITS AND VEGETABLES, FIVE ELEMENTS) plus counts entry for selected class/theme",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "Admin page: add School search/select; show selected school details read-only; allow setting/updating outstanding amount for that school",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Marketing page: when selecting/viewing a school, display that school’s outstanding amount (as set by Admin/Accounts)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-20",
      "summary": "Demo/Preview Mode: ensure all major pages/sections are usable end-to-end (register school, reflect across modules, update outstanding, packing edits) without broken flows",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Demo/Preview Mode: Accounts page must show selected school outstanding payment and allow updating/saving outstanding via an action; updated outstanding must reflect in Marketing (and other relevant views)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-22",
      "summary": "Marketing page updates: remove Register School button; show Total Schools and Total Outstanding; list each school with its outstanding; selecting a school shows full school details + outstanding + packing dispatch/return details + Class/Theme/Counts (from Packing)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "Demo/Preview Mode: Training page must allow selecting a school to create Queries and log/update Training Visits (purpose, contacted person, mobile) and support file upload",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "Demo/Preview Mode: Academic page must receive Trainer-raised queries and allow updating query status; status changes must reflect back on Trainer page",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Admin visibility: Admin should be able to view/monitor updates and details across Accounts/Marketing/Packing/Training/Academic (outstanding, packing details, visits, queries, statuses)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Academic Queries list/table: show School Name alongside School ID for each query",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-27",
      "summary": "Training Dashboard: add a solved queries overview (summary section for solved queries)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Training Visits: add an edit option to update existing training visit details",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Admin School details view: when selecting a school, show consolidated details from all modules (Accounts/Marketing/Packing/Training/Academic) and display who last updated each section/field based on login identity/audit data",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-30",
      "summary": "UI theme update: set Brand Name color to #e73d4b and use palette (#3bbcc4, #e73d4b, #28b06f) across UI components without changing any background colors",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-34",
      "summary": "Extend the backend TrainingVisit model and APIs to support updating an existing training visit, including audit logging of the update action with timestamp and initiator principal.",
      "reqIds": [
        "REQ-50"
      ],
      "status": "pending"
    },
    {
      "id": "AR-36",
      "summary": "Add/extend backend read APIs needed for the Admin consolidated school details view to efficiently retrieve (a) consolidated school-module data and (b) the latest relevant audit/update metadata per section, including initiator principal so the frontend can resolve names.",
      "reqIds": [
        "REQ-52"
      ],
      "status": "pending"
    },
    {
      "id": "AR-37",
      "summary": "UI polish/fix: Training → Edit screen should have a white background (it currently appears without background); apply additional appropriate background colors across screens as needed; do NOT implement the blurry header background (de-scoped due to missing header path).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-38",
      "summary": "UI fix (light mode): Demo/Preview Mode top-banner role switcher dropdown background should be white; Training Visit form container background should be white (entire form container, not just dialog content).",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Braindemics",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}